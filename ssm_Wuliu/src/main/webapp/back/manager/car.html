<!-- 司机 -->
<table id="car_data" data-options="fit:true"></table>


<div id="songSheet_search">
	<label>语种：</label>
	<select name="languages" id="songSheet_search_languages">
		<option value="">--全部--</option>
	</select>
	<label>风格：</label>
	<select name="style" id="songSheet_search_style">
		<option value="">--全部--</option>
	</select>
	<label>场景：</label>
	<select name="scene" id="songSheet_search_scene">
		<option value="">--全部--</option>
	</select>
	<label>情感：</label>
	<select name="emotion" id="songSheet_search_emotion">
		<option value="">--全部--</option>
	</select>
	<label>主题：</label>
	<select name="theme" id="songSheet_search_theme">
		<option value="">--全部--</option>
	</select>
	<label>用户名：</label>
	<input type="text" name="uname" id="songSheet_search_uname" class="songSheet_input">
	<label>歌单名：</label>
	<input type="text" name="ssname" id="songSheet_search_ssname" class="songSheet_input">
	<a href="javascript:songSheet_searchSongSheet()" class="easyui-linkbutton" data-options="iconCls:'icon-report-magnify'">查询</a> 
</div>


<style>
#songSheet_search label{
	margin-left:20px;
}
</style>

<script type="text/javascript">
var carEditRow=undefined;
var carOp;
var carflag;

var carObject=$('#car_data').datagrid({
	url:'../../findAllcar.action',
	//queryParams:{op:"find"},
	fitColumns:true,
	striped:true,
	loadMsg:'数据加载中。。。。',
	rownumbers:true,
	pagination:true,
	pageNumber:1,
	pageSize:5,
	pageList:[5,10,20,30,50],
	sortName:'cid',
	remoteSort:false,
	columns:[[   
	          {field:"car",checkbox:true},
	          {field:'cid',title:'车辆编号',width:80,align:'center',sortable:true},   
	          {field:'shipPoint.spid',title:'公司编号',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'shipPoint.spname',title:'所属公司',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'cnumber',title:'车牌号',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'ctype',title:'汽车类型',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'cvolume',title:'容积(m^3)',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'cton',title:'吨位',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'status',title:'车辆状态',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'box',title:'箱式',width:80,align:'center',editor:{type:"text",options:{required:true}}},
	          {field:'remark4',title:'操作',width:80,align:'center',formatter:function(val,row,index){
	        	  return "<a id='operation' href='javascript:detail("+val+")' style='color:#39f' >详情</a>&nbsp;&nbsp;<a id='operation' href='javascript:update("+val+")' style='color:#39f'>修改</a>"
	          }}
	]],
	toolbar:[{
    	text:"添加",	
    	iconCls: 'icon-user-add',
    	handler: function(){
    		if(carEditRow==undefined){
    			carObject.datagrid('insertRow',{index:0,row:{}});
        		carObject.datagrid('beginEdit',0);
    			carEditRow=0;//记录当前正在别编辑的行的索引
    			carOp="addcar";
    			carflag="添加";
    		}
    	}
    },'-',{
    	text:"修改",
    	iconCls: 'icon-user-edit',
    	handler: function(){
    		if(carEditRow!=undefined){
    			carObject.datagrid("rejectChanges");
    			carEditRow=undefined;
    		}
    		var row = carObject.datagrid("getChecked")[0];
    		if(row==undefined){
    			$.messager.show({title:'温馨提示',msg:'请编辑你要修改的数据...',timeout:2000,showType:'slide'});
    			
    		}else{
    			carEditRow = carObject.datagrid("getRowIndex",row);
    			carObject.datagrid('beginEdit',carEditRow);
    			carOp="updatecar";
    			carflag="修改";
    		}
    	}
    },'-',{
    	
    	text:"删除",
    	iconCls: 'icon-user-delete',
    	handler: function(){
    		var rows = carObject.datagrid("getChecked");
    		if(rows.length<0){
    			$.messager.show({title:'温馨提示',msg:'请编辑你要删除的数据...',timeout:2000,showType:'slide'});
    		}else{
    			$.messager.confirm('确认提示','数据一旦删除将不能恢复，您确定要删除吗？',function(r){
    				if(r){
    					var aids="";
    					for(var i=0,len=rows.length;i<len-1;i++){
    						aids+=rows[i].did+",";
    					}
    					aids+=rows[i].did;
    					$.post("../../delcar.action",{did:aids},function(data){
    	    				data=parseInt($.trim(data));
    	    				if(data>0){
    	    					$.messager.show({title:'温馨提示',msg:'司机信息删除成功...',timeout:2000,showType:'slide'});
    	    	    			carObject.datagrid("reload");
    	    				}else{
    	    					$.messager.alert('失败提示','司机信息删除失败。。。。','error');
    	    				}
    	    			},"text");
    				}else{
    					return;
    				}
    			});
    		}
    	}
    },'-',{
    	
    	text:"保存",
    	iconCls: 'icon-user-tick',
    	handler: function(){
    		if(carEditRow!=undefined){//说明正在被编辑的行
    			carObject.datagrid("endEdit",carEditRow);
    			carEditRow=undefined;
    		}
    		var row = carObject.datagrid("getChanges")[0];
    		if(row==undefined){
    			$.messager.show({title:'温馨提示',msg:'请编辑你要'+carflag+'的数据...',timeout:2000,showType:'slide'});
    		}else{
    			row["op"]=carOp+".action";
    			$.post("../../"+row["op"],row,function(data){
    				data=parseInt($.trim(data));
    				if(data>0){
    					$.messager.show({title:'温馨提示',msg:'司机信息'+carflag+'成功...',timeout:2000,showType:'slide'});
    	    			carObject.datagrid("reload");
    				}else{
    					$.messager.alert('失败提示','司机信息'+carflag+'失败。。。。','error');
    					location.href.reload();
    				}
    			},"text");
    		}
    	}
    	
	},'-',{
    	text:"撤销",
    	iconCls: 'icon-undo',
    	handler: function(){
    		carObject.datagrid("rejectChanges");
			carEditRow=undefined;
    	}	
	
	}]
		
});



</script>
